<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hindi Spell Checker</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        textarea { width: 80%; height: 150px; margin: 10px 0; font-size: 18px; }
        button { padding: 10px; font-size: 16px; cursor: pointer; }
        #spellCheckedText { font-size: 18px; color: black; margin-top: 10px; border: 1px solid #ccc; padding: 10px; min-height: 50px; }
        .highlight { color: red; font-weight: bold; border-bottom: 2px dotted red; cursor: pointer; }
        #debugOutput { border: 1px solid #ccc; padding: 10px; max-height: 150px; overflow: auto; text-align: left; font-size: 14px; background: #f9f9f9; }
    </style>
</head>
<body>

    <h2>Hindi Spell Checker (Mangal to Krutidev Input)</h2>
    
    <textarea id="unicodeText" placeholder="Mangal (Unicode) text paste karo..."></textarea><br>
    <button onclick="checkSpelling()">Check Spelling</button>
    
    <h3>Spell Checked Text:</h3>
    <div id="spellCheckedText" contenteditable="true"></div>

    <h3>Debug Output:</h3>
    <pre id="debugOutput"></pre> <!-- Debugging ke liye API response yahan show hoga -->

    <script>
        async function checkSpelling() {
            let text = document.getElementById("unicodeText").value;
            let apiUrl = "https://practice-production-e8b9.up.railway.app/spell-check"; // Backend API URL
            
            try {
                let response = await fetch(apiUrl, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ text: text })
                });

                if (!response.ok) {
                    throw new Error("Server Response: " + response.status + " " + response.statusText);
                }

                let result = await response.json();

                // Debugging ke liye API response dikhana
                document.getElementById("debugOutput").textContent = JSON.stringify(result, null, 2);

                let checkedText = result.checkedText.map(wordObj => {
                    if (!wordObj.correct) {
                        return `<span class="highlight" contenteditable="true" oninput="convertKrutidev(this)">${wordObj.word}</span>`;
                    } else {
                        return wordObj.word;
                    }
                }).join(" ");

                document.getElementById("spellCheckedText").innerHTML = checkedText;
            } catch (error) {
                document.getElementById("debugOutput").textContent = "Error: " + error.message;
            }
        }

        function convertKrutidev(span) {
            let krutidevText = span.innerText;
            let conversionMap = {
                "¼": "अ", "½": "आ", "¾": "इ", "¿": "ई", "À": "उ",
                "Á": "ऊ", "Â": "ऋ", "Ã": "ए", "Ä": "ऐ", "Å": "ओ",
                "Æ": "औ", "Ç": "अं", "È": "अः", "É": "ऍ", "Ê": "ऑ",
                "Ë": "ऒ", "Ì": "ऎ", "Í": "औ़",
                
                "Š": "क", "‹": "ख", "Œ": "ग", "Ž": "घ", "": "ङ",
                "": "च", "’": "छ", "“": "ज", "”": "झ", "•": "ञ",
                "–": "ट", "—": "ठ", "˜": "ड", "™": "ढ", "š": "ण",
                "›": "त", "œ": "थ", "ž": "द", "Ÿ": "ध", " ": "न",
                "¡": "प", "¢": "फ", "£": "ब", "¤": "भ", "¥": "म",
                "¦": "य", "§": "र", "¨": "ल", "©": "व", "ª": "श",
                "«": "ष", "¬": "स", "­": "ह", "®": "क्ष", "¯": "त्र",
                "°": "ज्ञ",

                "±": "ा", "³": "ि", "´": "ी", "µ": "ु", "¶": "ू",
                "·": "ृ", "¸": "े", "¹": "ै", "º": "ो", "»": "ौ",
                "²": "ँ", "Î": "़", "Ï": "्",

                "&": "्", "Û": "़", "×": "।", "Ø": "॥", "Ù": "₹",

                "0": "०", "1": "१", "2": "२", "3": "३", "4": "४",
                "5": "५", "6": "६", "7": "७", "8": "८", "9": "९"
            };

            let unicodeText = "";
            for (let char of krutidevText) {
                unicodeText += conversionMap[char] || char;
            }

            span.innerText = unicodeText;
        }
    </script>

</body>
</html>
